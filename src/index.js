const web3Utils = require('web3-utils');

const emojis = [128169, 128123, 129302, 127875, 129313, 129413, 128034, 128020, 128039, 128065, 128077, 128078, 127797, 127758, 127752, 127823, 9917, 9730, 11088, 128640, 127829, 128663, 127993, 127911, 128273, 127929, 10084, 127794, 128121, 128069, 128293, 128132, 128125, 129419, 128029, 128044, 127819, 127820, 129472, 127846, 127856, 129409, 127936, 127941, 127922, 128690, 128641, 127774, 127822, 127821, 129373, 129361, 127813, 9200, 128176, 128142, 128222, 128163, 9986, 128274, 128269, 9999, 9992, 128652, 128659, 128757, 9973, 9875, 128678, 9924, 127805, 9940, 129412, 10067, 9888, 127359, 128350, 128083, 127801, 128375, 128013, 128012, 128010, 129416, 128011, 127789, 127925, 9851, 128276, 127937, 128212, 128218, 128206, 128204, 127818, 127827, 127828, 127839, 127871, 127849, 129371, 127850, 9749, 127852, 129365, 127826, 129374, 129370, 129360, 127838, 127824, 127815, 127817, 128043, 128024, 129423, 129421, 128014, 128017, 128056, 128175, 9728, 9760, 128060, 9889, 128172, 9884, 128526, 128561, 127755, 127958, 127771, 127918, 10052, 128045, 128053, 128722, 129348, 9729, 128208, 127804, 127800, 128167, 127786, 127812, 128170, 128027, 127930, 128155, 128154, 128153, 128156, 128075, 128296, 128161, 128679, 127921, 128298, 127913, 127955, 9971, 9975, 127938, 128225, 127853, 128165, 128037, 9752, 128031, 128241, 128096, 128374, 128188, 127868, 128030, 128028, 128376, 129422, 129408, 127942, 9878, 128301, 127891, 128300, 128247, 127873, 128081, 128064, 127916, 128048, 127912, 127908, 127928, 128138, 128137, 127777, 128701, 128676, 9978, 128025, 129414, 129417, 129415, 128052, 128041, 129345, 127923, 128515, 128519, 128569, 127795, 128539, 128642, 128066, 128745, 127890, 127798, 127834, 9000, 127814, 128202, 127869, 128267, 128452, 128203, 128478, 128250, 127909, 128191, 128234, 128004, 128019, 129362, 129372, 129366, 127874, 127851, 128084, 128087, 127803, 9968, 127881, 128230, 128063, 128110, 128119, 127183, 128091, 128026, 127809, 128035, 127859, 127914, 129354, 9881, 128197];

/**
 * Return an emoji hash representation of a string
 *
 * @method emojiHash
 * @param {String} str
 * @return {String} the emoji hash string
 */
module.exports = function emojiHash(str) {
    const hash = web3Utils.sha3(str);
    const hashBuffer = Buffer.from(hash.slice(2), 'hex');
    const hashArray = Array.prototype.slice.call(hashBuffer, 0, 4);
    return hashArray.map(idx => String.fromCodePoint(emojis[idx])).join('');
}
